<!DOCTYPE html>
<html>
<head>
  <title>AQI Map</title>
  <script type="text/javascript" src="https://www.bing.com/api/maps/mapcontrol?callback=GetMap"></script>
  <style>
    #map {
      width: 800px;
      height: 600px;
    }
  </style>
</head>
<body>
  <input id="location" type="text" placeholder="Enter a location" />
  <button id="submit">Get AQI</button>
  <div id="map"></div>

  <script>
    var map;
    var aqiLayer;

    function GetMap() {
      map = new Microsoft.Maps.Map(document.getElementById('map'), {
        credentials: 'Ar-x_oaZ5J-md-Wra2_LJEG3NJt2uG0-HyqDMad50QptHo52WOTGIJYrnl83_nZw'
      });

      aqiLayer = new Microsoft.Maps.Layer();
      map.layers.insert(aqiLayer);
    }

    document.getElementById('submit').addEventListener('click', function() {
      var location = document.getElementById('location').value.trim();
      fetch(`https://tiles.aqicn.org/tiles/usepa-aqi/{z}/{x}/{y}.png?token=b1645b13-fa2f-4d0c-8fa9-b98cbc41d7f1`)
        .then(response => response.json())
        .then(data => {
          var aqiValue = data.results[0].measurements[0].value;
          var aqiCategory = getAQICategory(aqiValue);

          var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(data.results[0].coordinates.latitude, data.results[0].coordinates.longitude), {
            title: `AQI: ${aqiValue}`,
            description: `AQI Category: ${aqiCategory}`
          });
          aqiLayer.pushpins.push(pushpin);
        });
    });

    function getAQICategory(aqiValue) {
      // Implement AQI category logic here
      // For example:
      if (aqiValue < 50) {
        return 'Good';
      } else if (aqiValue < 100) {
        return 'Moderate';
      } else {
        return 'Unhealthy';
      }
    }
  </script>
</body>
</html>
